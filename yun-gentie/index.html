<html xmlns:wb="http://open.weibo.com/wb">

<head>
    <!-- meta信息 -->
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <!-- for 360 指定内核 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="csrf-param" content="authenticity_token">
    <meta name="csrf-token" content="Ye1jEU+Jp2rM7U9W18w9f90L1uyFRscRzNhiJxi1nAB0IUfqi2aCk4ccfPMIHMsFaNujKu7s9dGA44uMo33NPw==">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    <!-- 样式表 -->
    <link rel="stylesheet" media="all" href="/css/style.css">
    <link rel="stylesheet" media="screen" href="/css/screen.css">

    <!-- 不知道是什么 -->
    <style type="text/css">
        .p_spBanner {
            margin: 20px 0 40px;
        }

        .p_spBanner_sm {
            display: none;
        }

        @media (max-width: 600px) {
            .p_spBanner_bg {
                display: none;
            }
            .p_spBanner_sm {
                display: inline;
                ;
            }
        }
    </style>

    <!--[if lt IE 9]>
    <script src="https://alioss.g-cores.com/assets/html5shiv-99cb6d655922cd55cf310aa415c20655b29fc141d48778feb15f0ca3c732cf0a.js"></script><script src="https://alioss.g-cores.com/assets/respond/1.4.2/respond.min-5098b6c38985756e424a7c59535a58c3e6c616881478ab726f0837c5c7ef8ff0.js"></script>

      <link href="https://alioss.g-cores.com/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
      <link href="/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
      <script src="/respond.proxy.js"></script>
  <![endif]-->

    <!-- 标题 -->
    <title>机核</title>

    <!-- seo信息 -->
    <meta name="keywords" content="游戏,游戏电台,游戏广播,游戏播客,电视游戏,家用机游戏,单机游戏,游戏论坛,游戏新闻,游戏视频.">
    <meta name="description" content="从游戏到生活，我们生产内容，关乎你喜爱的一切。">

    <!-- rss地址 -->
    <link href="https://www.g-cores.com/rss" rel="alternate" type="application/rss+xml" title="Gamecores Feed">

    <!-- 安卓app图标 -->
    <link rel="apple-touch-icon" href="/touch-icon-iphone.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png">

    <!-- <script src="https://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script> -->

</head>

<body class="body-fixedNavbar">
    <!-- 顶部菜单栏 -->
        <nav class="navbar navbar-default navbar-fixed-top" id="j_app_navbar" role="navigation">
      <div class="container">
        <div class="navbar_header">
          <!-- 小屏幕切换按钮 -->
          <button type="button" class="navbar_toggle" data-toggle="collapse" data-target="#j_navbarCollapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>

          <a class="navbar_brand navbar_brand-logo" id="j_logo" href="/">
            <img src="/img/logo-mini.png"
              alt="我道">
          </a>
        </div>
    
        <!-- 功能区 -->
        <div class="collapse collapsed navbar_collapse" id="j_navbarCollapse">
          <ul class="nav navbar_nav navbar_right">
            <li>
              <a href="https://www.g-cores.com/account/signup">RSS</a>
            </li>
          </ul>
          <form class="navbar_search" action="https://www.g-cores.com/search" accept-charset="UTF-8" method="get">
            <input name="utf8" type="hidden" value="✓">
            <span class="fa fa-search"></span>
            <input type="text" name="keyword" placeholder="Search">
          </form>
    
          <!-- 菜单项 -->
          <ul class="nav navbar_nav navbar_right" id="j_nav">
            
            <li>
              <a class="" n_type="" href="/">
                首页
              </a>
            </li>
            
            <li>
              <a class="" n_type="" href="/links.html">
                左邻
              </a>
            </li>
            
            <li>
              <a class="" n_type="" href="/archive.html">
                归档
              </a>
            </li>
            
            <li>
              <a class="" n_type="" href="/about.html">
                关于
              </a>
            </li>
            
            <li>
              <a class="" n_type="" href="/rss.xml">
                订阅
              </a>
            </li>
            
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
    </nav>

    <!-- 不知道是什么 -->
    <style type="text/css">
        .navbar_brand-logo {
            padding-left: 15px !important;
            margin-left: 0 !important;
        }

        .navbar_brand-affix {
            padding-right: 0 !important;
        }

        @media (min-width: 992px) {
            .navbar_brand-affix {
                margin-left: -50px !important;
            }
            .navbar_brand-logo {
                padding-left: 0 !important;
                margin-left: 0 !important;
            }
        }

        .navbar_brand-affix img {
            margin: -8px 0 0 0;
            display: inline-block !important;
        }

        .navbar_brand-affix .navbar_brand-affix_red {
            display: none !important;
        }

        .navbar_brand-affix:hover .navbar_brand-affix_white {
            display: none !important;
        }

        .navbar_brand-affix:hover .navbar_brand-affix_red {
            display: inline !important;
        }
    </style>

    <!-- 引入网页主体 -->
    <div class="wrapper">
    <!-- 文章特色图片 -->
    <div class="story_header" style="background-image: url('http://cdn.4zen.top/image/7/e1/71ab3d9fe111d1d42dd1c05c11334.png')">
        <div class="story_header_cover"></div>
        <div class="story_header_imgContainer">
            <div class="story_header_imgContainer_img">
                <img data-no-retina="" alt="网易云跟帖适配ajax主题，动态加载评论框" src="http://cdn.4zen.top/image/7/e1/71ab3d9fe111d1d42dd1c05c11334.png">
            </div>
        </div>
        <div class="story_header_cover story_header_cover-second"></div>
        <div class="story_header_inner">
            <div class="story_header_text">
                <h1 class="story_title" id="j_title_preview">
                    网易云跟帖适配ajax主题，动态加载评论框
                </h1>

                <p class="story_info">2017-03-26</p>
            </div>
        </div>
        <a class="story_user" href="/users/64104">
            <div class="story_user_border">
                <img src="/img/avatar.png" alt="1900">
            </div>
            <p class="story_user_name">
                1900
            </p>
        </a>
        <div class="story_consoles">
        </div>
    </div>

    <div class="p_disclaimer">
        本文系用户投稿，不代表机核网观点
    </div>



    <div id="j_story_18172" class="story">
        <!-- 文章主体 -->
        <p>2017年3月29日上午：（经测试发现无法评论）。。<br>2017年3月29日中午：刷新博客发现早上发的评论居然出来了，网易云跟帖的审核速度未免也太“快”了把？。。<br><strong>总结：还是不要使用该款评论组件。。</strong></p>
<p>~~自从前几天多说宣布停止服务后我一直在寻找另外一个我喜欢的第三方评论组件，最喜欢的应该是disqus了，主要是因为他的游客评论功能，目前国内除多说外的组件似乎都强制用户登录才可以发表评论。我觉得这就像是我去旅游别人强制我买东西一样蛋疼…</p>
<p>但是我还是妥协了，我发现国内似乎没有第二个多说这样的组件了，我很遗憾…，后来在这些流氓组件中选来选去最后还是考虑换上了<a href="https://gentie.163.com/index.html" target="_blank" rel="external">网易云跟帖</a>（各种不爽，各种无法自定义…），由于官方没有提供一些文档和接口，导致和我的主题各种水土不服…，当时的心情是崩溃的…，后来没辙，还是得想办法治呀。只得去研究网易的js。</p>
<h3 id="分析一下"><a href="#分析一下" class="headerlink" title="#分析一下"></a>#分析一下</h3><p>网易提供的代码如下</p>
<pre><code>&lt;div id=&quot;cloud-tie-wrapper&quot; class=&quot;cloud-tie-wrapper&quot;&gt;&lt;/div&gt;
&lt;script&gt;
  var cloudTieConfig = {
    url: document.location.href, 
    sourceId: &quot;&quot;,
    productKey: &quot;0a1d8640929c49d3aad1489a8d785e28&quot;,
    target: &quot;cloud-tie-wrapper&quot;
  };
&lt;/script&gt;
&lt;script src=&quot;https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js&quot;&gt;&lt;/script&gt;
</code></pre><p>代码和多说的基本上差不多，</p>
<ol>
<li>一个div元素用来放加载的元素，</li>
<li>一个存放用户信息的json，</li>
<li>一个引用的加载脚本js文件。</li>
</ol>
<p>看了下代码，网易的这个loader.js虽然代码做了混淆，但是不难看出里面其实只有一个主函数，作用就是加载评论的数据，</p>
<pre><code>!
function(e) {//这是主函数，
    function t(e, t) {
        var n = document.createElement(&quot;script&quot;);
        return n.src = e,
        n.async = !1,
        n.charset = &quot;utf-8&quot;,
        t ? l.appendChild(n) : h.appendChild(n),
        n
    }
//中间代码比较多，就不贴全了
...
    var d = /\.js$/,
    c = /\.css$/,
    h = document.createDocumentFragment(),
    u = !1,
    l = document.head || document.getElementsByTagName(&quot;head&quot;)[0];
    window.yunManualLoad || window.yunModuleEnv || (o() ? r(&quot;aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vbW9iaWxlL2xpdmVzY3JpcHQuaHRtbA==&quot;, !0) : r(&quot;aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s&quot;, !0)),
    e.Tie = e.Tie || {},
    e.Tie.loader = r
} (window);//这里是调用
</code></pre><h3 id="改改试试看"><a href="#改改试试看" class="headerlink" title="#改改试试看"></a>#改改试试看</h3><p>我抱着试一下的心态，删掉感叹号，并且给主函数加个名字，方便之后调用。</p>
<pre><code>function yload(e) {//这是主函数，
    function t(e, t) {
        var n = document.createElement(&quot;script&quot;);
        return n.src = e,
        n.async = !1,
        n.charset = &quot;utf-8&quot;,
        t ? l.appendChild(n) : h.appendChild(n),
        n
    }
...
    var d = /\.js$/,
    c = /\.css$/,
    h = document.createDocumentFragment(),
    u = !1,
    l = document.head || document.getElementsByTagName(&quot;head&quot;)[0];
    window.yunManualLoad || window.yunModuleEnv || (o() ? r(&quot;aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vbW9iaWxlL2xpdmVzY3JpcHQuaHRtbA==&quot;, !0) : r(&quot;aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s&quot;, !0)),
    e.Tie = e.Tie || {},
    e.Tie.loader = r
};//这里的加载调用也删掉
</code></pre><p>然后在在网页的主js里面定义一个配置json</p>
<pre><code>var cloudTieConfig = {
    url: document.location.href, //网易云的文章不是通过多说那种id形式，而是直接以url的形式来定义。
    sourceId: &quot;&quot;,
    productKey: &quot;0a1d8640929c49d3aad1489a8d785e28&quot;,
    target: &quot;cloud-tie-wrapper&quot;//用来存放评论元素的容器id
};
</code></pre><p>然后在需要的地方调用之前更改好的yload(windows)就可以动态加载评论框了。</p>
<p>我意外的发现居然能行得通…为了让多朋友知道所以写了这片拙劣的文章，希望能帮到大家</p>
<h3 id="要注意的地方"><a href="#要注意的地方" class="headerlink" title="#要注意的地方"></a>#要注意的地方</h3><p>但是要注意哦，你定义函数的js文件要比网易云的哪个加载文件后引入哦，不然会找不到配置json的。而且，因为是动态调用的加载函数，所以每次调用前还需要更新<code>cloudTieConfig</code>变量中的url字段；最后调用的情况大概就是下面这个样子了（这里因为发现多次调用的话会重复添加评论框，所以我判断了如果容器里有内容就不会重复加载）</p>
<pre><code>if ($(&quot;#cloud-tie-wrapper&quot;).html() == &quot;&quot;) {
    cloudTieConfig.url = document.location.href;//设置当前文章的url
    yload(window)//调用函数
};
</code></pre><p>好了大概就是这样了，以上的内容只能当作参考，我也转业很久没写代码了，有什么解释错误的地方大家可以指出来，我好改正，谢谢。</p>
<p>Enjoy~~~</p>

    </div>

    <!-- meta信息 -->
    <div class="story_socialActions">
        <a href="javascript:;" id="j_original_like" class="story_like ">
            <span class="fa fa-thumbs-up"></span>
            <strong id="j_original_likesNum">218</strong>
        </a>
        <a href="javascript:;" id="j_original_mark" class="story_bookmark " title="收藏">
            <span class="fa fa-star"></span>
        </a>
        <a href="javascript:;" id="j_shareToWeibo" class="story_share">
            <span class="fa fa-weibo"></span>
        </a>
        <a href="javascript:;" id="j_shareToWXBtn" data-toggle="popover" title="" data-placement="top" data-container="body" data-original-title="微信扫一扫">
            <span class="fa fa-weixin"></span>
        </a>

    </div>


    <!-- 相关阅读 -->
    <div class="row story_recommendations">
        
        <div class="col-md-6">
            <a class="story_header" style="background-image: url('http://cdn.4zen.top/image/c/40/c78cb5d808649e80d3e10100fccea.jpg')"
                href="http://www.1900.live/qi-yong-xin-zhu-ti-cdc4g/">
                <div class="story_header_cover"></div>
                <div class="story_header_cover story_header_cover-second"></div>
                <div class="story_header_inner">
                    <div class="story_header_text prev">
                        <p class="story_recommendations_head">
                            上一篇
                        </p>
                        <h2 class="story_recommendations_title">
                            启用新主题：CDC4G!
                        </h2>
                        <p class="story_recommendations_info">
                            多说是我用的第一个第三方评论组件，也是我一直用到现在的评论组件。
但是，现在要和多说说再见了，以后都不能多说了….，这个结果官方其实也一直在暗示把：服务器时常抽风、官网从去年开始就没有更新过、官方论坛&hellip;</p>
                        </p>
                    </div>
                </div>
            </a>
        </div>
        
        
        <div class="col-md-6">
            <a class="story_header" style="background-image: url('http://cdn.4zen.top/image/d/a2/a1ff56777f893b0ed90dc80739b00.png')"
                href="http://www.1900.live/duoshuo-bye/">
                <div class="story_header_cover"></div>
                <div class="story_header_cover story_header_cover-second"></div>
                <div class="story_header_inner">
                    <div class="story_header_text">
                        <p class="story_recommendations_head">
                            下一篇
                        </p>
                        <h2 class="story_recommendations_title">
                            再见
                        </h2>
                        <p class="story_recommendations_info">
                            多说是我用的第一个第三方评论组件，也是我一直用到现在的评论组件。
但是，现在要和多说说再见了，以后都不能多说了….，这个结果官方其实也一直在暗示把：服务器时常抽风、官网从去年开始就没有更新过、官方论坛&hellip;</p>
                        </p>
                    </div>
                </div>
            </a>
        </div>
        
    </div>

    <!-- 评论区 -->
    <div class="comments_backdrop">
        <div class="container">
        </div>
    </div>

</div>

    <!-- 引入页脚文件 -->
        <!-- 页脚 -->
    <footer class="footer">
        <div class="footer_contact">
            <a href="mailto:haolun@g-cores.com" target="_blank">CONTACT US | 联系我们</a>
        </div>
        <div class="footer_info">
            <img class="footer_top" data-no-retina="" src="https://alioss.g-cores.com/assets/footer_top-4c293a683d2aece39281f2cf7e9bb022c2e55dfbd963d2862d20e3690eea91ae.jpg"
                alt="">
    
            <div class="footer_logos">
                <a href="https://www.g-cores.com/categories/13">
                    <img data-no-retina="" src="https://alioss.g-cores.com/assets/footer/gadio-01-e8679bfc838ae676eead7fa354c6ab7e26f3ec7bbf093c58ccaa647ae7701de4.png"
                        alt="">
                </a>
                <a href="https://www.g-cores.com/categories/12">
                    <img data-no-retina="" src="https://alioss.g-cores.com/assets/footer/gadiopro-01-3bbe85deb999275b31c7658a0e09299751850497bbee7e10cedb6a83ab29de75.png"
                        alt="">
                </a>
                <a href="https://www.g-cores.com/categories/14">
                    <img data-no-retina="" src="https://alioss.g-cores.com/assets/footer/music-01-a744efa6c6fbba4474e9f2a4b4de64347065eddc7e9ebccc375a7de2e9829f74.png"
                        alt="">
                </a>
                <a href="https://www.g-cores.com/categories/15">
                    <img data-no-retina="" src="https://alioss.g-cores.com/assets/footer/docu-01-8640c29ee16770157814443d1dbd01ccd5b3cf007b249db6fc6523b295662d2a.png"
                        alt="">
                </a>
                <a href="https://www.g-cores.com/categories/16">
                    <img data-no-retina="" src="https://alioss.g-cores.com/assets/footer/special-01-69dcd46be43114fa958e1d969bc14297e12b193dd753fb924e07e0beff25dd37.png"
                        alt="">
                </a>
            </div>
    
            <div class="footer_follow">
                <h4>Follow us</h4>
                <p>
                    <a href="http://weibo.com/gamecore" target="_blank" class="footer_weibo"></a>
                    <a href="javascript:;" class="footer_weixin" data-toggle="tooltip" data-placement="top" title="" data-original-title="微信号：gamecores，欢迎订阅"></a>
                    <a href="http://shop124260606.taobao.com" target="_blank" class="footer_taobao"></a>
                    <a href="http://itunes.apple.com/cn/podcast/id420660752" target="_blank" class="footer_podcast"></a>
                    <a href="https://www.g-cores.com/rss" target="_blank" class="footer_rss"></a>
                </p>
            </div>
    
            <p>
                All Rights Reserved 2009-2015 GAMECORES - Terms &amp; Conditions 闽ICP备11023385号-1
            </p>
        </div>
    </footer>

    <!-- 回到顶部按钮 -->
    <a href="javascript:;" class="toTop" id="j_toTop" style="display:none;">
        <img src="https://alioss.g-cores.com/assets/totop-4489de3bdf698735aae759e5da990bc8ecb48fd5852e674fc5ba4fcdddfd3471.png" alt="">
    </a>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="/js/index.js"></script>

</body>

</html>